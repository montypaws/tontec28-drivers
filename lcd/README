This is forked from @Galen67's code from http://www.raspberrypi.org/forums/viewtopic.php?f=91&t=64414&start=75

Please refer to that thread for more information.
